<!-- 按钮组件 -->
<template id="cbutton">
    <!--layerPage-->
    <block>
        <!--layerPage   ：加载弹窗页面-->
        <!--fullScreen  ：全屏和退出全屏-->
        <a href="javascript:;" 
                v-on:click="type=='layerPage' && doLayerPage()"
                v-on:click="type=='fullScreen' && doFullScreen()"
                v-if="type=='layerPage' || type=='fullScreen'"
            >
            <button type="button" class="am-btn am-btn-default" 
                    v-bind:class=" btn_style ? styles[btn_style] : ''"
                    v-bind:class=" size ? sizes[size] : ''"
                >
                <span v-bind:class=" icon ? icons[icon] : 'am-icon-plus'"></span> {{button_name}}
            </button>
        </a>
        
        <!--表格中的操作按钮-->
        <a href="javascript:;" v-on:click="doLayerPage()" v-if="type=='tableOperate'">
            <i v-bind:class=" icon ? icons[icon] : 'am-icon-plus'"></i> {{button_name}}
        </a>
    </block>
</template>

<script>
    //定义hblock组件
    Vue.component('cbutton', {
        props: ['type','button_name','url','height','width','form_data','btn_style','icon','size'],
        template: '#cbutton',
        data: function(){
            return {
                //按钮尺寸
                "sizes" :{
                    'normal' : '',
                    'small'  : 'am-btn-sm'
                },
                //按钮样式
                'styles':{
                    "default" :"am-btn-default",
                    "primary":"am-btn-primary",
                    "secondary":"am-btn-secondary",
                    "warning":"am-btn-warning",
                    "danger":"am-btn-danger",
                    "success":"am-btn-success",
                    "link":"am-btn-link"
                },
                //图标
                'icons':{
                    "slack"         :"am-icon-slack",
                    "plus"          :"am-icon-plus",
                    "cloud-download":"am-icon-cloud-download",
                    "wordpress"     :"am-icon-wordpress",
                    "openid"        :"am-icon-openid",
                    "yahoo"         :"am-icon-yahoo",
                    "google"        :"am-icon-google",
                    "reddit"        :"am-icon-reddit",
                    "stumbleupon"   :"am-icon-stumbleupon",
                    "pencil"        :"am-icon-pencil",
                }
            };
        },
        methods : {
            /**
             * 普通弹窗
             * @param {type} url        url
             * @param {type} formData   表单数据
             * @param {type} width      宽度
             * @param {type} height     高度
             * @param {type} refresh    刷新与否
             * @returns {undefined}
             */
            doLayerPage : function ( ){
                //弹层
                var layerIndex  = layer.load(2);                
                var that        = this;
                //url
                var url         = this.url;
                //表单数据
                var formData    = this.form_data;
                //高度
                var width       = this.width;
                //宽度
                var height      = this.height;

                $.ajax({
                    url:  url,
                    type: 'POST',
                    data :formData,
                    beforeSend: function( xhr ) { 
                        xhr.setRequestHeader('X-Requested-With', {toString: function(){ return ''; }}); 
                    }, 
                    success: function (data) {
                        console.log(data);
                        //关闭弹层
                        layer.close(layerIndex);
                        layer.open({
                            type: 1,
                            skin: 'layui-layer-rim', //加上边框
                            area: [width, height], //宽高
                            end : function () {

                            },
                            content: data
                        });                            
                    }
                });
            },
            doFullScreen : function(){
                console.log('doFullScreen开始执行');
                fullscreen();
            }
        },
        created :function(){
//            console.log('cbutton开始执行');
        }
    });
</script>
